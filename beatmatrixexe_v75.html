<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Controlador MIDI Gestual v74</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #111;
      color: white;
      font-family: sans-serif;
    }
    video, canvas {
      position: absolute;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      transform: scaleX(-1);
      z-index: 0;
    }
    #grid {
      display: grid;
      /* grid-template-columns will be set by JS */
      gap: 10px; /* Consider a smaller gap if pads can be small */
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }
    .pad {
      /* width and height will be set by JS */
      background: #333;
      border: 2px solid #888;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      user-select: none;
      font-size: 24px;
      transition: 0.2s;
    }
    .pad.active {
      background: #0f0;
      border-color: #fff;
      color: #111;
      box-shadow: 0 0 20px #0f0;
    }
    .pad.highlight {
      box-shadow: 0 0 10px 5px yellow;
      border-color: yellow;
    }
    .pad.sequencer-column-indicator {
      background-color: #444; /* A slightly lighter gray than default #333 */
    }
    .pad.sequencer-column-indicator-vertical {
      background-color: #5e5e00; /* Um amarelo escuro/oliva para diferenciar */
    }
    #controls-container {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 20;
      background: rgba(50,50,50,0.8);
      padding: 15px;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    #controls-container label, #controls-container button, #controls-container select, #controls-container input {
      margin-right: 5px;
    }
    .control-group {
        display: flex;
        align-items: center;
        gap: 5px;
        margin-bottom: 5px;
    }
    #bpm-display {
        margin-left: 10px;
    }

    #horizontalFaderContainer {
      text-align: center;
      margin-top: 5px; /* Adjusted margin */
    }

    #horizontalBpmFaderSVG {
      /* SVG already has width/height attributes */
    }

    #horizontalBpmFaderSVG .track { /* Assuming you might style a visible track for the BPM fader */
      stroke: #555;
      stroke-width: 8;
      fill: none;
    }

    #horizontalBpmFaderSVG .progress-arc { /* If using arc for BPM, otherwise adapt */
      stroke: #0f0;
      stroke-width: 8;
      fill: none;
      stroke-linecap: round;
    }

    #horizontalBpmFaderSVG .knob { /* Assuming a knob for BPM fader */
      fill: #0f0;
      stroke: #fff;
      stroke-width: 1;
      cursor: pointer;
    }
     #bpmTextDisplay { /* Style for the text within the BPM fader SVG */
        font-family: Arial, sans-serif;
        font-size: 16px;
        fill: white;
        text-anchor: middle;
    }
  </style>
</head>
<body>

<div id="controls-container">
  <div class="control-group">
    <label for="midi-out">MIDI Out:</label>
    <select id="midi-out"></select>
  </div>
  <div class="control-group">
    <button id="play-stop-button">Play</button>
    <div id="bpm-display">BPM: 120</div>
  </div>

  <!-- Horizontal BPM Fader -->
  <div id="horizontalFaderContainer">
      <svg id="horizontalBpmFaderSVG" width="250" height="60"> <!-- Adjusted width -->
          <defs>
              <linearGradient id="faderTrackGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" style="stop-color:#a0a0a0;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e0e0e0;stop-opacity:1" />
              </linearGradient>
          </defs>
          <rect id="faderTrack" x="10" y="20" width="230" height="10" rx="5" ry="5" fill="url(#faderTrackGradient)" stroke="#505050" stroke-width="1"/>
          <rect id="faderThumb" x="10" y="15" width="20" height="20" rx="3" ry="3" fill="#4CAF50" stroke="#388E3C" stroke-width="1" style="cursor: pointer;"/>
          <text id="bpmTextDisplay" x="125" y="50" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle">BPM: 120</text>
      </svg>
  </div>

  <div class="control-group">
    <label for="rowsInput">Linhas: <span id="rowsValueDisplay">4</span></label>
    <input type="range" id="rowsInput" value="4" min="1" max="16" style="width: 120px;">
  </div>
  <div class="control-group">
    <label for="colsInput">Colunas: <span id="colsValueDisplay">4</span></label>
    <input type="range" id="colsInput" value="4" min="1" max="16" style="width: 120px;">
  </div>
  <div class="control-group">
    <label for="padSizeInput">Tam. CÃ©lula: <span id="padSizeValueDisplay">60</span>px</label>
    <input type="range" id="padSizeInput" value="60" min="20" max="100" step="1" style="width: 120px;">
  </div>

  <hr style="border-color: #555; margin: 15px 0;">

  <!-- Controles para a Segunda Barra (Vertical) -->
  <div class="control-group">
    <button id="play-stop-button-vertical">Play Barra Vert</button>
    <div id="bpm-display-vertical">BPM Vert: 120</div>
  </div>

  <div id="horizontalFaderContainerVertical">
      <svg id="horizontalBpmFaderSVGVertical" width="250" height="60">
          <rect id="faderTrackVertical" x="10" y="20" width="230" height="10" rx="5" ry="5" fill="url(#faderTrackGradient)" stroke="#505050" stroke-width="1"/>
          <rect id="faderThumbVertical" x="10" y="15" width="20" height="20" rx="3" ry="3" fill="#FFC107" stroke="#FFA000" stroke-width="1" style="cursor: pointer;"/>
          <text id="bpmTextDisplayVertical" x="125" y="50" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle">BPM Vert: 120</text>
      </svg>
  </div>

</div>

<video id="video" autoplay playsinline muted></video>
<canvas id="canvas"></canvas>
<div id="grid"></div>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
<script src="beatmatrixexe_v75.js"></script>

</body>
</html>
